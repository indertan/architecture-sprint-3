# Часть 1.
# Задание 1. Анализ и планирование.

### Задание 1.1. Изучите функциональность монолитного приложения.
Система "Smart Home Monolith" представляет собой монолитное приложение для управления отоплением и мониторинга температуры в умном доме. 
Пользователи могут включать/выключать отопление, устанавливать температуру в системе отопления и получать информацию о текущей температуре.

### Задание 1.2. Проанализируйте архитектуру монолитного приложения.
- **Язык программирования**: Java - строго типизированный объектно-ориентированный язык программирования высокого уровня.
    - Плюсы:
        1) Независимость от платформы
        2) Автоматическая сборка мусора
        3) Поддержка большого сообщества
    - Минусы:
        1) Относительно низкая производительность
        2) Значительное использование памяти
- **База данных**: PostgreSQL - свободная объектно-реляционная СУБД.
    - Плюсы
        1) Расширяемость (открытый исходный код)
        2) Надежность
        3) Масштабируемость
- **Архитектура**: Монолитная, все компоненты системы находятся в рамках одного приложения.
    - Плюсы:
        1) Одна кодовая база (легче отлаживать)
        2) Одна база данных
        3) Снижение издержек на обслуживание инфраструктуры
    - Минусы:
        1) Внесение изменений в рамках единой кодовой базы может приводить к непредсказуемым ошибкам
        2) Длительный цикл разработки и развертывания системы
        3) Трудно масштабировать отдельные компоненты системы
- **Взаимодействие**: Синхронное, запросы обрабатываются последовательно. Плюсы: простота, прозрачность. Минусы: может приводить к недоступности системы.
- **Развертывание**: Требует остановки всего приложения. Процесс равертывания линейный, но возникает недоступность приложения при развертывании.

### Задание 1.3. Определите домены и границы контекстов.
Можно выделить следующие домены (исходя из описания и имеющейся кодовой базы, [диаграмма с описанием доменов](diagrams/asis/domain/Domain.puml))
- Умные устройства
- Пользователи

### Задание 1.4. Проведите анализ архитектуры монолитного приложения.
Основные недостатки текущего решения:
- Нет возможности точечного масштабирования функционала. Из-за этого, при серьезной нагрузке, могут возникнуть проблемы с масштабированием
- Необходимость полной остановки системы при любом изменении системы будет означать значительное время недоступности системы клиентам
- Внесение изменений в рамках единой кодовой базы может приводить к непредсказуемым ошибкам
- Длительный цикл разработки и развертывания системы
- Синхронное взаимодействие с датчиками может приводить к недоступности системы (количество исполняющих потоков обычно ограничено, 
при долгом ответе от устройств система может подвисать из-за занятости всех потоков получением данных от устройств).

### Задание 1.5. Визуализируйте контекст системы.
[Диаграмма контекста текущего решения](diagrams/asis/context/Context.puml)

# Задание 2. Проектирование микросервисной архитектур

### Задание 2.1. Декомпозируйте приложение на микросервисы.
Исходя из требований к целовой системе можно выделить следующие домены ([диаграмма с описанием доменов](diagrams/tobe/domain/Domain.puml))

Монолитное решение разделено на следующие микросервисы
- Микросервис управления пользователями
- Микросервис управления устройствами
- Микросервис управления умным домом
- Микросервис управления сценариями
- Микросервис управления телеметрией

Также отдельно выделен компонент по взаимодействию с датчиками (шлюз)

### Задание 2.2. Определите взаимодействия.
Все входящие клиентские запросы поступают на API Gateway, которые осуществляет их маршрутизацию по микросервисам. 
Микросервисы хранят свои данные в БД (Postgresql + MongoDB + ClickHouse). Обмен данными между микросервисами происходит асинхронно, 
через брокер Kafka путем публикации событий.

### Задание 2.3. Визуализируйте архитектуры.
[Диаграмма контейнеров](diagrams/tobe/container/Container.puml)

[Диаграмма компонентов микросервиса устройств](diagrams/tobe/component/Device.puml)  
[Диаграмма компонентов микросервиса пользовательских сценариев](diagrams/tobe/component/Scenario.puml)  
[Диаграмма компонентов микросервиса умных домов](diagrams/tobe/component/SmartHome.puml)  
[Диаграмма компонентов микросервиса телеметрии](diagrams/tobe/component/Telemetry.puml)  
[Диаграмма компонентов микросервиса пользователей](diagrams/tobe/component/User.puml)  

[Диаграмма кода микросервиса устройств](diagrams/tobe/code/Device.puml)

# Задание 3. Разработка ER-диаграммы
[Диаграмма ER](diagrams/tobe/er/ER.puml)

# Часть 2.
# Задание 1. Создание и документирование API

[Документация OpenAPI](api/openapi.yaml)  
[Документация AsyncAPI](api/asyncapi.yaml)
